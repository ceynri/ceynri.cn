---
import type { CollectionEntry } from 'astro:content';
import { BaseHead, Footer, FormattedDate, PostTags, TopNavbar } from '~/components';

type Props = CollectionEntry<'blog'>['data'];

const { title, description, date, lastmod, cover_image } = Astro.props;
---

<html lang="zh-CN">
  <head>
    <BaseHead title={title} description={description ?? ''} />
  </head>

  <body>
    <TopNavbar />
    <div class="mt-16 max-sm:mt-0 px-8 max-sm:px-0">
      <main class="mx-auto max-w-[50rem] p-[var(--prose-padding)] bg-[var(--prose-bg-color)] transition-[background-color] ease-out rounded-3xl max-sm:rounded-none">
        {cover_image
          ? (
          <div class="relative overflow-hidden rounded-t-3xl max-sm:rounded-t-none -mx-[var(--prose-padding)] -mt-[var(--prose-padding)] mb-8 bg-gray-100">
            <img
              class="w-full max-sm:min-h-[100vw] object-cover"
              style={{
                aspectRatio: `${cover_image.width} / ${cover_image.height}`,
              }}
              src={cover_image.src}
              alt="cover image"
            />
            <div class="absolute left-4 bottom-8 sm:left-16 sm:bottom-12">
              <h1 class="text-3xl font-bold text-white text-shadow-lg">{title}</h1>
              <div class="mt-3 text-white text-shadow-lg">
                <FormattedDate date={date} />
              </div>
            </div>
          </div>
          )
          : (
            <div class="pt-8 mb-16 flex flex-col items-center">
              <h1 class="text-3xl font-bold">{title}</h1>
              <div class="mt-3">
                <FormattedDate date={date} />
              </div>
            </div>
          )}
        <article class="prose">
          <slot />
          {lastmod && (
            <blockquote class="mt-12">Last modified on <FormattedDate date={lastmod} />.</blockquote>
          )}
        </article>
        <PostTags tags={Astro.props.tags} class="mt-8" />
      </main>
    </div>
    <Footer class="text-center" />
  </body>
</html>
